<div class="container">
  <h2>Projects & Teams</h2>

  <div class="projeto">
    <h3>Projeto: Minhas Tarefas</h3>

    <div class="kanban">

      <!-- Em Atraso -->
      <div class="kanban-col"
           cdkDropList
           id="atraso"
           [cdkDropListData]="tarefasEmAtrasoArray"
           [cdkDropListConnectedTo]="['afazer','emandamento','concluidas']"
           (cdkDropListDropped)="drop($event, 'Em Atraso')">
        <h4>Em atraso</h4>
        <div class="kanban-cards">
          <div class="card" *ngFor="let tarefa of tarefasEmAtrasoArray" cdkDrag (click)="abrirModal(tarefa)">
            <div class="card-header">
              <h3>{{ tarefa.titulo }}</h3>
              <span class="status-badge" [ngClass]="tarefa.flag">{{ tarefa.flag }}</span>
            </div>
            <p><strong>Vencimento:</strong> {{ tarefa.dataVencimento | date:'dd/MM/yyyy' }}</p>
            <p><strong>Descrição:</strong> {{ tarefa.descricao }}</p>
            <p><strong>Status:</strong> {{ tarefa.statusExecucao }}</p>
          </div>
        </div>
      </div>

      <!-- A Fazer -->
      <div class="kanban-col"
           cdkDropList
           id="afazer"
           [cdkDropListData]="tarefasAFazerArray"
           [cdkDropListConnectedTo]="['atraso','emandamento','concluidas']"
           (cdkDropListDropped)="drop($event, 'A Fazer')">
        <h4>A Fazer</h4>
        <div class="kanban-cards">
          <div class="card" *ngFor="let tarefa of tarefasAFazerArray" cdkDrag (click)="abrirModal(tarefa)">
            <div class="card-header">
              <h3>{{ tarefa.titulo }}</h3>
              <span class="status-badge" [ngClass]="tarefa.flag">{{ tarefa.flag }}</span>
            </div>
            <p><strong>Vencimento:</strong> {{ tarefa.dataVencimento | date:'dd/MM/yyyy' }}</p>
            <p><strong>Descrição:</strong> {{ tarefa.descricao }}</p>
            <p><strong>Status:</strong> {{ tarefa.statusExecucao }}</p>
          </div>
        </div>
      </div>

      <!-- Em Andamento -->
      <div class="kanban-col"
           cdkDropList
           id="emandamento"
           [cdkDropListData]="tarefasEmAndamentoArray"
           [cdkDropListConnectedTo]="['atraso','afazer','concluidas']"
           (cdkDropListDropped)="drop($event, 'Em Andamento')">
        <h4>Em Andamento</h4>
        <div class="kanban-cards">
          <div class="card" *ngFor="let tarefa of tarefasEmAndamentoArray" cdkDrag (click)="abrirModal(tarefa)">
            <div class="card-header">
              <h3>{{ tarefa.titulo }}</h3>
              <span class="status-badge" [ngClass]="tarefa.flag">{{ tarefa.flag }}</span>
            </div>
            <p><strong>Vencimento:</strong> {{ tarefa.dataVencimento | date:'dd/MM/yyyy' }}</p>
            <p><strong>Descrição:</strong> {{ tarefa.descricao }}</p>
            <p><strong>Status:</strong> {{ tarefa.statusExecucao }}</p>
          </div>
        </div>
      </div>

      <!-- Concluídas -->
      <div class="kanban-col concluidas"
           cdkDropList
           id="concluidas"
           [cdkDropListData]="tarefasConcluidasArray"
           [cdkDropListConnectedTo]="['atraso','afazer','emandamento']"
           (cdkDropListDropped)="drop($event, 'Concluido')">
        <h4>Concluídas</h4>
        <div class="kanban-cards">
          <div class="card concluidas" *ngFor="let tarefa of tarefasConcluidasArray" cdkDrag (click)="abrirModal(tarefa)">
            <div class="card-header">
              <h3>{{ tarefa.titulo }}</h3>
              <span class="status-badge" [ngClass]="tarefa.flag">{{ tarefa.flag }}</span>
            </div>
            <p><strong>Vencimento:</strong> {{ tarefa.dataVencimento | date:'dd/MM/yyyy' }}</p>
            <p><strong>Descrição:</strong> {{ tarefa.descricao }}</p>
            <p><strong>Status:</strong> {{ tarefa.statusExecucao }}</p>
          </div>
        </div>
      </div>

    </div>
  </div>

  <button class="btn-flutuante" (click)="abrirCriarModal()">
    <i class="fas fa-plus"></i>
  </button>

  <app-vertarefas 
    *ngIf="tarefaSelecionada"  
    [tarefa]="tarefaSelecionada"
    (fechar)="fecharModal()"
    (editar)="editarTarefa($event)">
  </app-vertarefas>

  <app-criartarefas
    *ngIf="exibirCriarTarefa"
    [tarefa]="tarefaParaEdicao"
    (fechar)="fecharCriarModal()"
    (salvar)="tarefaCriada($event)">
  </app-criartarefas>
</div>
