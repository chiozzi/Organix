<div class="container">
  <h2>Painel de Tarefas</h2>

  <!-- Linha com A Fazer e Em Andamento -->
  <div class="kanban row justify-content-center">

    <!-- A Fazer -->
    <div id="afazer" class="col-md-4 kanban-col"
         cdkDropList
         [cdkDropListData]="tarefasAFazer"
         [cdkDropListConnectedTo]="['emandamento','concluidas']"
         (cdkDropListDropped)="drop($event)">
      <h4>ğŸ“ A Fazer</h4>
      <div class="kanban-cards">
        <div class="card mb-2"
             *ngFor="let tarefa of tarefasAFazer"
             [ngClass]="{'removendo': tarefa.removendo}"
             cdkDrag
             [cdkDragData]="tarefa"
             (click)="abrirModal(tarefa)">
          <div class="card-header">
            <h5>{{ tarefa.titulo }}</h5>
            <span class="status-badge {{ tarefa.flag | lowercase }}">{{ tarefa.flag }}</span>
          </div>
          <p><strong>Vencimento:</strong> {{ tarefa.dataVencimento | date:'dd/MM/yyyy' }} Ã s {{ tarefa.horaVencimento }}</p>
          <p><strong>DescriÃ§Ã£o:</strong> {{ tarefa.descricao }}</p>
          <p><strong>Status:</strong> A Fazer</p>
        </div>
      </div>
    </div>

    <!-- Em Andamento -->
    <div id="emandamento" class="col-md-4 kanban-col"
         cdkDropList
         [cdkDropListData]="tarefasEmAndamento"
         [cdkDropListConnectedTo]="['afazer','concluidas']"
         (cdkDropListDropped)="drop($event)">
      <h4>âš™ï¸ Em Andamento</h4>
      <div class="kanban-cards">
        <div class="card mb-2"
             *ngFor="let tarefa of tarefasEmAndamento"
             [ngClass]="{'removendo': tarefa.removendo}"
             cdkDrag
             [cdkDragData]="tarefa"
             (click)="abrirModal(tarefa)">
          <div class="card-header">
            <h5>{{ tarefa.titulo }}</h5>
            <span class="status-badge {{ tarefa.flag | lowercase }}">{{ tarefa.flag }}</span>
          </div>
          <p><strong>Vencimento:</strong> {{ tarefa.dataVencimento | date:'dd/MM/yyyy' }} Ã s {{ tarefa.horaVencimento }}</p>
          <p><strong>DescriÃ§Ã£o:</strong> {{ tarefa.descricao }}</p>
          <p><strong>Status:</strong> Em Andamento</p>
        </div>
      </div>
    </div>

  </div> <!-- fecha linha principal -->

  <!-- Painel ConcluÃ­das (abaixo, centralizado e largo) -->
  <div id="concluidas" class="kanban-col concluido-col"
       [ngClass]="{ 'compactado': !mostrarConcluidas }"
       cdkDropList
       [cdkDropListData]="tarefasConcluidas"
       [cdkDropListConnectedTo]="['afazer','emandamento']"
       (cdkDropListDropped)="drop($event)">

    <div class="kanban-header">
      <h4>âœ… ConcluÃ­das</h4>
      <button class="toggle-btn" (click)="alternarConcluidas()" title="Mostrar/Ocultar tarefas">
        <i class="fas" [ngClass]="mostrarConcluidas ? 'fa-eye-slash' : 'fa-eye'"></i>
      </button>
    </div>

    <div class="kanban-cards concluidas-cards" [class.oculto]="!mostrarConcluidas">
      <div class="card mb-2"
           *ngFor="let tarefa of tarefasConcluidas"
           [ngClass]="{'removendo': tarefa.removendo}"
           cdkDrag
           [cdkDragData]="tarefa"
           (click)="abrirModal(tarefa)">
        <div class="card-header">
          <h5>{{ tarefa.titulo }}</h5>
          <span class="status-badge {{ tarefa.flag | lowercase }}">
            {{ tarefa.flag }}
          </span>
        </div>
        <p><strong>Vencimento:</strong> {{ tarefa.dataVencimento | date:'dd/MM/yyyy' }} Ã s {{ tarefa.horaVencimento }}</p>
        <p><strong>DescriÃ§Ã£o:</strong> {{ tarefa.descricao }}</p>
        <p><strong>Status:</strong> ConcluÃ­do</p>
      </div>
    </div>
  </div>

  <!-- BotÃ£o Flutuante -->
  <button class="btn-flutuante btn btn-primary" (click)="abrirCriarModal()">
    <i class="fas fa-plus"></i>
  </button>

  <!-- Modais -->
  <app-vertarefas
    *ngIf="tarefaSelecionada"
    [tarefa]="tarefaSelecionada"
    (fechar)="fecharModal()"
    (editar)="abrirCriarModal($event)"
    (excluir)="removerTarefa($event)"
    (concluir)="tarefaConcluida($event)">
  </app-vertarefas>

  <app-criartarefas
    *ngIf="exibirCriarTarefa"
    [tarefa]="tarefaParaEdicao"
    (salvar)="tarefaCriadaOuAtualizada($event)"
    (fechar)="exibirCriarTarefa=false">
  </app-criartarefas>
</div>
  