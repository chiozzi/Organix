<div class="container">
  <h2>Painel de Tarefas</h2>
  <div class="kanban row">

    <!-- Em atraso -->
    <div class="col-md-3 kanban-col"
         cdkDropList
         id="EmAtraso"
         [cdkDropListData]="tarefasEmAtraso"
         [cdkDropListConnectedTo]="['AFazer','EmAndamento','Concluido']"
         (cdkDropListDropped)="drop($event)">
      <h4>â° Em atraso</h4>
      <div class="kanban-cards">
        <div class="card mb-2" *ngFor="let tarefa of tarefasEmAtraso" 
             cdkDrag
             [cdkDragData]="tarefa"
             (click)="abrirModal(tarefa)">
          <div class="card-header">
            <h5>{{ tarefa.titulo }}</h5>
            <span class="status-badge {{ tarefa.flag | lowercase }}">{{ tarefa.flag }}</span>
          </div>
          <p><strong>Vencimento:</strong> {{ tarefa.dataVencimento | date:'dd/MM/yyyy' }}</p>
          <p><strong>DescriÃ§Ã£o:</strong> {{ tarefa.descricao }}</p>
          <p><strong>Status:</strong> Em Atraso</p>
        </div>
      </div>
    </div>

    <!-- A fazer -->
    <div class="col-md-3 kanban-col"
         cdkDropList
         id="AFazer"
         [cdkDropListData]="tarefasAFazer"
         [cdkDropListConnectedTo]="['EmAtraso','EmAndamento','Concluido']"
         (cdkDropListDropped)="drop($event)">
      <h4>ğŸ“ A fazer</h4>
      <div class="kanban-cards">
        <div class="card mb-2" *ngFor="let tarefa of tarefasAFazer" 
             cdkDrag
             [cdkDragData]="tarefa"
             (click)="abrirModal(tarefa)">
          <div class="card-header">
            <h5>{{ tarefa.titulo }}</h5>
            <span class="status-badge {{ tarefa.flag | lowercase }}">{{ tarefa.flag }}</span>
          </div>
          <p><strong>Vencimento:</strong> {{ tarefa.dataVencimento | date:'dd/MM/yyyy' }}</p>
          <p><strong>DescriÃ§Ã£o:</strong> {{ tarefa.descricao }}</p>
          <p><strong>Status:</strong> A Fazer</p>
        </div>
      </div>
    </div>

    <!-- Em andamento -->
    <div class="col-md-3 kanban-col"
         cdkDropList
         id="EmAndamento"
         [cdkDropListData]="tarefasEmAndamento"
         [cdkDropListConnectedTo]="['EmAtraso','AFazer','Concluido']"
         (cdkDropListDropped)="drop($event)">
      <h4>âš™ï¸ Em andamento</h4>
      <div class="kanban-cards">
        <div class="card mb-2" *ngFor="let tarefa of tarefasEmAndamento" 
             cdkDrag
             [cdkDragData]="tarefa"
             (click)="abrirModal(tarefa)">
          <div class="card-header">
            <h5>{{ tarefa.titulo }}</h5>
            <span class="status-badge {{ tarefa.flag | lowercase }}">{{ tarefa.flag }}</span>
          </div>
          <p><strong>Vencimento:</strong> {{ tarefa.dataVencimento | date:'dd/MM/yyyy' }}</p>
          <p><strong>DescriÃ§Ã£o:</strong> {{ tarefa.descricao }}</p>
          <p><strong>Status:</strong> Em Andamento</p>
        </div>
      </div>
    </div>

    <!-- ConcluÃ­das -->
    <div class="col-md-3 kanban-col concluidas"
         cdkDropList
         id="Concluido"
         [cdkDropListData]="tarefasConcluidas"
         [cdkDropListConnectedTo]="['EmAtraso','AFazer','EmAndamento']"
         (cdkDropListDropped)="drop($event)">
      <h4>âœ… ConcluÃ­das</h4>
      <div class="kanban-cards concluidas-cards">
        <div class="card mb-2" *ngFor="let tarefa of tarefasConcluidas" 
             cdkDrag
             [cdkDragData]="tarefa"
             (click)="abrirModal(tarefa)">
          <div class="card-header">
            <h5>{{ tarefa.titulo }}</h5>
            <span *ngIf="tarefa.flag !== Flag.Concluido" class="status-badge {{ tarefa.flag | lowercase }}">
              {{ tarefa.flag }}
            </span>
          </div>
          <p><strong>Vencimento:</strong> {{ tarefa.dataVencimento | date:'dd/MM/yyyy' }}</p>
          <p><strong>DescriÃ§Ã£o:</strong> {{ tarefa.descricao }}</p>
          <p><strong>Status:</strong> ConcluÃ­do</p>
        </div>
      </div>
    </div>

  </div>

  <!-- BotÃ£o flutuante de criar tarefa -->
  <button class="btn-flutuante btn btn-primary" (click)="abrirCriarModal()">
    <i class="fas fa-plus"></i>
  </button>

  <!-- Modal de visualizar tarefa -->
  <app-vertarefas
    *ngIf="tarefaSelecionada"
    [tarefa]="tarefaSelecionada"
    (fechar)="fecharModal()"
    (editar)="abrirCriarModal($event)"
    (excluir)="removerTarefa($event)"
    (concluir)="tarefaConcluida($event)">
  </app-vertarefas>


  <!-- Modal de criar/editar tarefa -->
  <app-criartarefas
    *ngIf="exibirCriarTarefa"
    [tarefa]="tarefaParaEdicao"
    (salvar)="tarefaCriadaOuAtualizada($event)"
    (fechar)="exibirCriarTarefa=false">
  </app-criartarefas>

</div>
